import 'package:flutter/material.dart';
import 'dart:async';

class HomeScreen extends StatefulWidget {
  const HomeScreen({Key? key}) : super(key: key);

  @override
  State<HomeScreen> createState() => _HomeScreenState();
}

class _HomeScreenState extends State<HomeScreen> {
  var counter = 0;

  /// Generate list of random colors which will be used to show
  /// different gradients in the background.
  List<Color> get getColorsList => [
        const Color(0xFF006E7F),
        const Color(0xFFF8CB2E),
        const Color(0xFFEE5007),
        const Color(0xFFB22727),
      ]..shuffle();

  /// Generate list of alignment which will be used to
  /// set gradient start and end for random color animation.
  List<Alignment> get getAlignments => [
        Alignment.bottomLeft,
        Alignment.bottomRight,
        Alignment.topRight,
        Alignment.topLeft,
      ];

  /// We will animate the gradient every 5 seconds.
  _startBgColorAnimationTimer() {
    /// Animating for the first time
    WidgetsBinding.instance.addPostFrameCallback((timeStamp) {
      counter++;
      setState(() {});
    });

    const interval = Duration(seconds: 5);
    Timer.periodic(
      interval,
      (Timer timer) {
        counter++;
        setState(() {});
      },
    );
  }

  /// Start animation
  @override
  void initState() {
    super.initState();
    _startBgColorAnimationTimer();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Stack(
        children: [
          AnimatedContainer(
            width: MediaQuery.of(context).size.width,
            height: MediaQuery.of(context).size.height,
            decoration: BoxDecoration(
                gradient: LinearGradient(
                    begin: getAlignments[counter % getAlignments.length],
                    end: getAlignments[(counter + 2) % getAlignments.length],
                    colors: getColorsList,
                    tileMode: TileMode.clamp)),
            duration: const Duration(seconds: 4),
          ),
          Container(
            height: MediaQuery.of(context).size.height,
          )
        ],
      ),
    );
  }
}
